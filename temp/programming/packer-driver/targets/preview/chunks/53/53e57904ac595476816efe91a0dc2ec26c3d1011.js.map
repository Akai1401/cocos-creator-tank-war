{"version":3,"sources":["file:///Users/akai/Data/cocos/TankWar/assets/script/tankCtrl.ts"],"names":["_decorator","Component","Input","input","instantiate","KeyCode","Prefab","Vec3","ccclass","property","Tank","direction","angle","speed","start","console","log","on","EventType","KEY_DOWN","onKeyDown","KEY_UP","onKeyUp","update","deltaTime","pos","node","getPosition","add","clone","multiplyScalar","setPosition","setRotationFromEuler","Fire","bullet","PlayerPos","parent","addChild","ARROW_LEFT","keyCode","x","ARROW_RIGHT","ARROW_UP","y","ARROW_DOWN","SPACE"],"mappings":"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","sourcesContent":["import {\n  _decorator,\n  Component,\n  EventKeyboard,\n  Input,\n  input,\n  instantiate,\n  KeyCode,\n  Node,\n  Prefab,\n  Vec3,\n} from \"cc\";\nconst { ccclass, property } = _decorator;\n\n@ccclass(\"Tank\")\nexport class Tank extends Component {\n  direction: Vec3 = new Vec3(0, 0, 0);\n  angle: Vec3 = new Vec3(0, 0, 0);\n  speed: number = 300;\n\n  @property(Prefab)\n  bullet: Prefab;\n\n  start() {\n    console.log(\"PlayerController start\");\n    input.on(Input.EventType.KEY_DOWN, this.onKeyDown, this);\n    input.on(Input.EventType.KEY_UP, this.onKeyUp, this);\n  }\n\n  update(deltaTime: number) {\n    let pos = this.node.getPosition();\n    pos.add(this.direction.clone().multiplyScalar(deltaTime));\n    this.node.setPosition(pos);\n    this.node.setRotationFromEuler(this.angle);\n  }\n\n  Fire() {\n    let bullet = instantiate(this.bullet);\n    const PlayerPos = this.node.getPosition();\n    bullet.setPosition(PlayerPos);\n    bullet.setRotationFromEuler(this.angle);\n    this.node.parent.addChild(bullet);\n  }\n\n  onKeyDown(EventType: EventKeyboard) {\n    if (KeyCode.ARROW_LEFT == EventType.keyCode) {\n      this.direction.x = -this.speed;\n      this.angle = new Vec3(0, 0, 90);\n      return;\n    }\n    if (KeyCode.ARROW_RIGHT == EventType.keyCode) {\n      this.direction.x = this.speed;\n      this.angle = new Vec3(0, 0, -90);\n      return;\n    }\n    if (KeyCode.ARROW_UP == EventType.keyCode) {\n      this.direction.y = this.speed;\n      this.angle = new Vec3(0, 0, 0);\n      return;\n    }\n    if (KeyCode.ARROW_DOWN == EventType.keyCode) {\n      this.direction.y = -this.speed;\n      this.angle = new Vec3(0, 0, 180);\n      return;\n    }\n    if (KeyCode.SPACE == EventType.keyCode) {\n      this.Fire();\n    }\n  }\n  onKeyUp(EventType: EventKeyboard) {\n    this.direction = new Vec3(0, 0, 0);\n  }\n}\n"]}